<!doctype html>
<html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="Gaël Varoquaux, computer / data / brain science"><link rel=alternate href=http://gael-varoquaux.info/feeds/all.atom.xml type=application/atom+xml title="Gaël Varoquaux Full Atom Feed"><title>Machine learning humour -- Gaël Varoquaux: computer / data / brain science</title><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css><link rel=stylesheet href=../theme/css/pure.css><script src=//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js></script></head><body><div class=pure-g-r id=layout><div class="sidebar sidebar-article pure-u"><header class=header-article><hgroup><a href=..><img class=avatar alt="Gaël Varoquaux" src=http://gael-varoquaux.info/images/gael.png></a><a href=.. class=article-info><h2 class=article-info>Gaël Varoquaux</h2></a><p>Thu 16 September 2010</p><a href=/>&larr;Home</a></hgroup></header></div><div class=pure-u><div class=content><section class=post><header class=post-header><h1>Machine learning humour</h1><p class=post-meta> under <a class=post-category href=../tag/personnal.html>personnal</a><a class=post-category href=../tag/python.html>python</a><a class=post-category href=../tag/humor.html>humor</a><span class=social_links><a href=http://twitter.com/share class=twitter-share-button data-count=horizontal data-via=GaelVaroquaux>Tweet</a><script type=text/javascript src=http://platform.twitter.com/widgets.js async defer></script><span class=g-plusone data-size=medium></span></span></p></header></section><div class=section id=yes-but-they-overfit><h2>Yes, but they overfit</h2><p>If you are reading this post through a planet, the movie isn’t showing up, just <a class="reference external" href=http://gael-varoquaux.info/science/machine-learning-humour.html>click through</a> to understand what the hell this is about.</p><p><object width=480 height=385><embed src="http://www.youtube.com/v/m60lVGz34hU?fs=1&amp;hl=en_US" type=application/x-shockwave-flash allowscriptaccess=always allowfullscreen=true width=480 height=385></object></p></div><div class=section id=some-explanations><h2>Some explanations…</h2><div class=section id=machine-learning-geeks-and-beers><h3>Machine learning, geeks, and beers</h3><p>Sorry for the bad humour. In the previous weeks my social geek life had two strong moments:</p><ul class=simple><li><a class="reference external" href=http://www.pycon.fr/conference/edition2010>Pycon fr</a>, the French Python conference, and ensuing drinking</li></ul><img alt src=http://farm5.static.flickr.com/4077/4938486734_378f52fd3d.jpg style="width: 45%;"><img alt src=http://farm5.static.flickr.com/4114/4938124265_027853c81a.jpg style="width: 45%;"><ul class=simple><li><a class="reference external" href=http://fseoane.net/blog/2010/second-scikitslearn-coding-sprint/>The second sprint</a> on the <a class="reference external" href=http://scikit-learn.sourceforge.net/>scikit learn</a>, a library for machine learning in Python.</li></ul><p>At the first event (or maybe the related drinking) there was a lot of discussion about NoSQL databases, and I was introduced to <a class="reference external" href="http://www.xtranormal.com/watch/6995033/&quot;&quot;">this fantastic video</a> making fun of MongoDB fanboys. A few days later I was hacking on the scikit, comparing estimators and discussing hype versus fact in machine learning algorithms (hint: <a class="reference external" href=http://en.wikipedia.org/wiki/No_free_lunch_in_search_and_optimization>there is no free lunch</a>, but you may get <a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.79.2501&amp;rep=rep1&amp;type=pdf">a free brunch</a>). As in brain imaging people seem to be doing nothing but SVMs over and over while <a class="reference external" href=http://hal.inria.fr/hal-00504095/PDF/icpr_2010_tv.pdf>methods with more appropriate sparsity clearly perform better</a>, I composed this stupid video.</p></div><div class=section id=anything-to-learn-about-machine-learning-in-there><h3>Anything to learn about machine learning in there?</h3><p>The short answer is: probably no. This video is humour, and there is little truth (well, RFE is indeed slow as a dog). However, not every reader of this blog are machine learning experts, so let me explain the stakes of the pseudo discussion.</p><p><strong>Overfitting</strong>: when you learn a predictive model on a noisy data set, for instance trying to learn how to predict whether a movie is popular or not from ratings, if you have a finite amount of data, you should be careful not to learn by heart every detail of the data. You will learn noise that, by chance, correlated to what you are trying to predict. When you try to generalize to new data, these features that you learned from noise will be detrimental to your prediction performance. For instance, <a class="reference external" href=http://www.reddit.com/r/Python/comments/cwq37/announcing_python_nltk_demos_natural_language/>the presence of Matt Damon</a> is not the sole predictor of the quality of movie. This is called overfitting. The goal of <a class="reference external" href=http://en.wikipedia.org/wiki/Regularization_%28mathematics%29>regularization</a> is to avoid this overfitting.</p><p>Both SVM and elasticnet implement regularization, but in different ways. In the case of brain imaging, as the predictive features (voxels) are very sparse, but the noise is highly structured, SVM (that do not operate on voxels directly) are not able to select directly the relevant voxels and tend to overfit (which can be counter-balanced by univariate feature selection as in the <a class="reference external" href=http://scikit-learn.org/stable/auto_examples/svm/plot_svm_anova.html>scikit example</a>).</p><p><strong>RFE (recursive feature elimination) is slow as dog</strong></p><div class=highlight><pre><span></span><span class=n>In</span> <span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=kn>from</span> <span class=nn>scikits.learn</span> <span class=kn>import</span> <span class=n>datasets</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>2</span><span class=p>]:</span> <span class=n>digits</span> <span class=o>=</span> <span class=n>datasets</span><span class=o>.</span><span class=n>load_digits</span><span class=p>()</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>3</span><span class=p>]:</span> <span class=n>X</span> <span class=o>=</span> <span class=n>digits</span><span class=o>.</span><span class=n>data</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>4</span><span class=p>]:</span> <span class=n>y</span> <span class=o>=</span> <span class=n>digits</span><span class=o>.</span><span class=n>target</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>5</span><span class=p>]:</span> <span class=kn>from</span> <span class=nn>scikits.learn.svm</span> <span class=kn>import</span> <span class=n>LinearSVC</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>6</span><span class=p>]:</span> <span class=n>svc</span> <span class=o>=</span> <span class=n>LinearSVC</span><span class=p>()</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>7</span><span class=p>]:</span> <span class=kn>from</span> <span class=nn>scikits.learn.rfe</span> <span class=kn>import</span> <span class=n>RFE</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>8</span><span class=p>]:</span> <span class=o>%</span><span class=n>timeit</span> <span class=n>RFE</span><span class=p>(</span><span class=n>estimator</span><span class=o>=</span><span class=n>svc</span><span class=p>,</span> <span class=n>n_features</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>percentage</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<span class=mi>1</span> <span class=n>loops</span><span class=p>,</span> <span class=n>best</span> <span class=n>of</span> <span class=mi>3</span><span class=p>:</span> <span class=mf>21.5</span> <span class=n>s</span> <span class=n>per</span> <span class=n>loop</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>9</span><span class=p>]:</span> <span class=kn>from</span> <span class=nn>scikits.learn.glm</span> <span class=kn>import</span> <span class=n>ElasticNet</span>
<span class=n>In</span> <span class=p>[</span><span class=mi>10</span><span class=p>]:</span> <span class=o>%</span><span class=n>timeit</span> <span class=n>ElasticNet</span><span class=p>(</span><span class=n>alpha</span><span class=o>=.</span><span class=mi>1</span><span class=p>,</span> <span class=n>rho</span><span class=o>=</span><span class=mf>0.7</span><span class=p>)</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
<span class=mi>10</span> <span class=n>loops</span><span class=p>,</span> <span class=n>best</span> <span class=n>of</span> <span class=mi>3</span><span class=p>:</span> <span class=mf>26.7</span> <span class=n>ms</span> <span class=n>per</span> <span class=n>loop</span>
</pre></div><p>Yeah, but it does much more than simply building a predictor, it builds a ‘heat map’ of which features help predicting (run <a class="reference external" href=http://scikit-learn.sourceforge.net/auto_examples/rfe_digits.html>this scikit-learn example</a> to get an idea).</p><p>I am afraid that all the examples I pointed to require the development version of the scikit. Sorry, we just finished a sprint, and there will be a release soon.</p></div></div><div class=hr style="margin-bottom: -.5em;"></div><span class=social_links><a href=http://twitter.com/share class=twitter-share-button data-count=horizontal data-via=GaelVaroquaux>Tweet</a><script type=text/javascript src=http://platform.twitter.com/widgets.js async defer></script><span class=g-plusone data-size=medium></span></span><a href=# class=go-top>Go Top</a><div class=comments><div id=disqus_thread></div><script type=text/javascript>
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "gaelvaroquaux"; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><footer class=footer><p>&copy; Gaël Varoquaux &ndash; Built with <a href=https://github.com/PurePelicanTheme/pure>Pure Theme</a> for <a href=http://blog.getpelican.com/>Pelican</a></p></footer></div></div></div><script src=//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js></script><script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script><script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script><script src=https://apis.google.com/js/platform.js async defer></script><script type=text/javascript>
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type=text/javascript>
        try {
            var pageTracker = _gat._getTracker("UA-55589822-1");
            pageTracker._trackPageview();
            } catch(err) {}
    </script></body></html>