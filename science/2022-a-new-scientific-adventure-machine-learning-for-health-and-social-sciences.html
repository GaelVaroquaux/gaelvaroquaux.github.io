<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Gaël Varoquaux, computer / data / health science">

        <link rel="alternate"  href="https://gael-varoquaux.info/feeds/all.atom.xml" type="application/atom+xml" title="Gaël Varoquaux Full Atom Feed"/>

        <title>2022, a new scientific adventure: machine learning for health and social sciences -- Gaël Varoquaux: computer / data / health science</title>

    <link href="https://mastodon.social/@GaelVaroquaux" rel="me">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.0/css/all.min.css">
    <link rel="stylesheet" href="https://gael-varoquaux.info/theme/css/pure.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <!-- OpenGraph -->
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://gael-varoquaux.info/science/2022-a-new-scientific-adventure-machine-learning-for-health-and-social-sciences.html" />
	<meta property="og:title" content="2022, a new scientific adventure: machine learning for health and social sciences" />
	<meta property="og:description" content="A retrospective on last year (2022): I embarked on a new scientific adventure, assembling a team focused on developing machine learning for health and social science. The team has existed for..." />
	<meta property="og:image" content="attachments/2022/team_2022.jpg" />
	<meta property="og:site_name" content="Gaël Varoquaux" />
    <meta property="og:logo" content="https://gael-varoquaux.info/images/gael.png" />
</head>

<body>
<div class="pure-g-r" id="layout">
    <div class="sidebar sidebar-article pure-u">
        <header class="header-article">
            <hgroup>
                <a href="https://gael-varoquaux.info">
		    <img class="avatar" alt="Gaël Varoquaux" 
                     src="https://gael-varoquaux.info/images/gael.png">
                </a>
                <a href="https://gael-varoquaux.info" class="article-info">
		    <h2 class="article-info">Gaël Varoquaux</h2>
		</a>
                <p>Tue 31 January 2023</p>
                <a href="/">&larr;Home</a>
            </hgroup>
        </header>
    </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>2022, a new scientific adventure: machine learning for health and social sciences</h1>
                        <p class="post-meta">
                            under                                 <a class="post-category" href="https://gael-varoquaux.info/tag/science.html">science</a>
                                <a class="post-category" href="https://gael-varoquaux.info/tag/research.html">research</a>
                                <a class="post-category" href="https://gael-varoquaux.info/tag/machine-learning.html">machine learning</a>
                                <a class="post-category" href="https://gael-varoquaux.info/tag/health.html">health</a>
                                <a class="post-category" href="https://gael-varoquaux.info/tag/statistics.html">statistics</a>
                                <a class="post-category" href="https://gael-varoquaux.info/tag/yearly-report.html">yearly report</a>
		    <span class="readtime">
			&nbsp Read time: 10 min.
		    </span>
<!--<script src="https://apis.google.com/js/platform.js" async defer></script>-->
<span class="social_links">
<!--<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="GaelVaroquaux">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js" async defer></script>
-->
<!-- Place this tag where you want the +1 button to render. -->
<span class="g-plusone" data-size="medium"></span>
</span>                        </p>
                </header>
            </section>
            <p>A retrospective on last year (2022): I embarked on a new scientific
adventure, assembling <a class="reference external" href="https://team.inria.fr/soda/">a team</a> focused on
developing machine learning for health and social science. The team has
existed for almost a year, and the vision is nice shaping up. Let me
share with you illustrations of where we are at. This is extracted from
our yearly report which will be public later, but I have sometimes edited
it a bit to add personal context.</p>
<div class="contents topic" id="highlights">
<p class="topic-title">Highlights</p>
<ul class="simple">
<li><a class="reference internal" href="#a-new-team-soda" id="toc-entry-1">A new team: Soda</a></li>
<li><a class="reference internal" href="#the-scientific-vision" id="toc-entry-2">The scientific vision</a><ul>
<li><a class="reference internal" href="#application-context-richer-data-in-health-and-social-sciences" id="toc-entry-3">Application context: richer data in health and social sciences</a></li>
<li><a class="reference internal" href="#applications-raise-specific-data-science-challenges" id="toc-entry-4">Applications raise specific data-science challenges</a></li>
<li><a class="reference internal" href="#our-research-axes" id="toc-entry-5">Our research axes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#some-notable-results-of-2022" id="toc-entry-6">Some notable results of 2022</a><ul>
<li><a class="reference internal" href="#learning-on-relational-data-aggregating-across-many-tables" id="toc-entry-7">Learning on relational data: aggregating across many tables</a></li>
<li><a class="reference internal" href="#validating-probabilistic-classifiers-beyond-calibration" id="toc-entry-8">Validating probabilistic classifiers: beyond calibration</a></li>
<li><a class="reference internal" href="#reweighting-randomized-trials-for-generalization-finite-sample-error-and-variable-selection" id="toc-entry-9">Reweighting randomized trials for generalization: finite sample error and variable selection</a></li>
<li><a class="reference internal" href="#challenges-to-clinical-impact-of-ai-in-medical-imaging" id="toc-entry-10">Challenges to clinical impact of AI in medical imaging</a></li>
<li><a class="reference internal" href="#privacy-preserving-synthetic-educational-data-generation" id="toc-entry-11">Privacy-preserving synthetic educational data generation</a></li>
</ul>
</li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="a-new-team-soda">
<h2><a class="toc-backref" href="#toc-entry-1">A new team: Soda</a></h2>
<div class="figure align-right">
<img alt="" src="attachments/2022/team_2022.jpg" style="width: 400px;" />
<p class="caption">The team in early 2022 (it has grown a lot since)</p>
</div>
<p>At <a class="reference external" href="https://www.inria.fr/en">Inria</a>, we have teams assembling multiple
tenured researchers around a scientific project. Last year, we assembled
a new team called <a class="reference external" href="https://team.inria.fr/soda/">Soda</a>, which stands for
“social data”, but above all is a fun name.</p>
<p>In a year, the team grew like crazy (to be honest, this had been baking
for a little while). We are now around 25 people.
There are 4 PIs (Marine le Morvan, Judith Abécassis, Jill-Jênn Vie, and
myself); and the engineers working on scikit-learn at Inria are also part
of the team.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="the-scientific-vision">
<h2><a class="toc-backref" href="#toc-entry-2">The scientific vision</a></h2>
<p class="align-right"><em>Machine learning to leverage richer, more complex, data for
social-sciences and health</em></p>
<div class="section" id="application-context-richer-data-in-health-and-social-sciences">
<h3><a class="toc-backref" href="#toc-entry-3">Application context: richer data in health and social sciences</a></h3>
<p>Opportunistic data accumulations, often observational, bare great
promises for social and health sciences. But the data are too big and
complex for standard statistical methodologies in these sciences.</p>
<p><strong>Health databases</strong> Increasingly rich health data is accumulated
during routine clinical practice as well as for research. Its large
coverage brings new promises for public health and personalized medicine,
but it does not fit easily in standard biostatistical practice because it
is not acquired and formatted for a specific medical question.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Social, educational, and behavioral sciences</strong> Better data sheds new
light on human behavior and psychology, for instance with on-line
learning platforms. Machine learning can be used both as a model for
human intelligence and as a tool to leverage these data, for instance
improving education.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="applications-raise-specific-data-science-challenges">
<h3><a class="toc-backref" href="#toc-entry-4">Applications raise specific data-science challenges</a></h3>
<p><strong>Data management: preparing dirty data for analytics</strong> Assembling,
curating, and transforming data for data analysis is very labor
intensive. These data-preparation steps are often considered the number
one bottleneck to data-science. They mostly rely on data-management
techniques. A typical problem is to establishing correspondences between
entries that denote the same entities but appear in different forms
(entity linking, including deduplication and record linkage). Another
time-consuming process is to join and aggregate data across multiple
tables with repetitions at different levels (as with panel data in
econometrics and epidemiology) to form a unique set of “features” to
describe each individual.</p>
<div class="sidebar">
The <a class="reference external" href="https://project.inria.fr/dirtydata/">Dirty Data project</a> paved the way.</div>
<p>Progress in machine learning increasingly helps automating data
preparation and processing data with less curation.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Data science with statistical machine learning</strong> Machine learning can
be a tool to answer complex domain questions by providing non-parametric
estimators. Yet, it still requires much work, eg to go beyond point
estimators, to derive non-parametric procedures that account for a
variety of bias (censoring, sampling biases, non-causal associations), or
to provide theoretical and practical tools to assess validity of
estimates and conclusion in weakly-parametric settings.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="our-research-axes">
<h3><a class="toc-backref" href="#toc-entry-5">Our research axes</a></h3>
<div class="section" id="representation-learning-for-relational-data">
<h4>Representation learning for relational data</h4>
<p>I dream of deep-learning methodology for relational databases, from
tabular datasets to full relational databases. The stakes are <em>i)</em> to
build machine-learning models that apply readily to the raw data so as to
minimize manual cleaning, data formatting and integration, and <em>ii)</em> to
extract reusable representations that reduce sample complexity on new
databases by transforming the data in well-distributed vectors.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mathematical-aspects-of-statistical-learning-for-data-science">
<h4>Mathematical aspects of statistical learning for data science</h4>
<p>I want to use machine learning models as non-parametric estimators, as I
worry about the impact of mismodeling on conclusion. However, for a given
statistical task, the statistical procedures and validity criterion need
to be reinvented. Soda contributes statistical tools and results for a
variety of problems important to data science in health and social
science (epidemiology, econometrics, education). These fields lead to
various statistical topics:</p>
<ul class="simple">
<li>Missing values</li>
<li>Causal inference</li>
<li>Model validation</li>
<li>Uncertainty quantification</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="machine-learning-for-health-and-social-sciences">
<h4>Machine learning for health and social sciences</h4>
<p>Soda targets applications in health and social sciences, as these can
markedly benefit from advanced processing of richer datasets, can have a
large societal impact, but fall out of mainstream machine-learning
research, which focus on processing natural images, language, and voice.
Rather, data surveying humans needs another focus: it is most of the time
tabular, sparse, with a time dimension, and missing values. In term of
application fields, we focus on the social sciences that rely on
quantitative predictions or analysis across individuals, such as policy
evaluation. Indeed, the same formal problems, addressed in the two
research axes above, arise across various social sciences:
<strong>epidemiology, education research, and economics</strong>.
The challenge is to develop efficient and trustworthy machine learning
methodology for these high-stakes applications.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="high-quality-data-science-software">
<h4>High-quality data-science software</h4>
<p>Societal and economical impact of machine learning requires easy-to-use
practical tools that can be leveraged in non-specialized organizations
such as hospitals or policy-making institutions.</p>
<p>Soda incorporates the core team working at Inria on <strong>scikit-learn</strong>, one
of the most popular machine-learning tool world-wide. One of the missions
of soda is to improve scikit-learn and its documentation, transfering the
understanding of machine learning and data science accumulated by the
various research efforts.</p>
<p>Soda works on other important software tools to foster growth and health
of the Python data ecosystem in which scikit-learn is embedded.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="some-notable-results-of-2022">
<h2><a class="toc-backref" href="#toc-entry-6">Some notable results of 2022</a></h2>
<p>I am listing here a small number of the achievements of the team, because
I find them inspiring.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="learning-on-relational-data-aggregating-across-many-tables">
<h3><a class="toc-backref" href="#toc-entry-7">Learning on relational data: aggregating across many tables</a></h3>
<p>For many machine-learning tasks, augmenting the data table at hand with
features built from external sources is key to improving performance. For
instance, estimating housing prices benefits from background information
on the location, such as the population density or the average income.</p>
<div class="figure align-right">
<img alt="" src="attachments/2022/aggregating.png" style="width: 300px;" />
<p class="caption">Often, data must be assembled across multiple tables into a single
table for analysis. Challenges arise due to one-to-many relations,
irregularity of the information, and the number of tables that may be
involved.</p>
</div>
<p>Most often, a major bottleneck is to <strong>assemble this information across
many tables</strong>, requiring time and expertise from the data scientist. We
propose <strong>vectorial representations of entities (e.g. cities) that capture
the corresponding information</strong> and thus can replace human-crafted
features. In <a class="reference external" href="https://link.springer.com/article/10.1007/s10994-022-06277-7">Cvetkov-Iliev 2023</a>, we
represent the relational data on the entities as a graph and adapt
graph-embedding methods to create feature vectors for each entity. We
show that two technical ingredients are crucial: modeling well the
different relationships between entities, and capturing numerical
attributes. We adapt knowledge graph embedding methods that were
primarily designed for graph completion. Yet, they model only discrete
entities, while creating good feature vectors from relational data also
requires capturing numerical attributes. For this, we introduce KEN:
Knowledge Embedding with Numbers. We thoroughly evaluate approaches to
enrich features with background information on 7 prediction tasks. We
show that a good embedding model coupled with KEN can perform better than
manually handcrafted features, while requiring much less human effort. It
is also competitive with combinatorial feature engineering methods, but
much more scalable. Our approach can be applied to huge databases, for
instance on general knowledge graphs as in YAGO, creating <strong>general-purpose
feature vectors reusable in various downstream tasks</strong>.</p>
<div class="figure align-center">
<img alt="" src="attachments/2022/entity_types_with_names.png" style="width: 100%;" />
<p class="caption"><strong>Entity embeddings of YAGO (wikipedia)</strong> (2D-representation using
UMAP). The vectors are downloadable from
<a class="reference external" href="https://soda-inria.github.io/ken_embeddings">https://soda-inria.github.io/ken_embeddings</a>} to readily augment
data-science projects.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="validating-probabilistic-classifiers-beyond-calibration">
<h3><a class="toc-backref" href="#toc-entry-8">Validating probabilistic classifiers: beyond calibration</a></h3>
<div class="figure align-right">
<img alt="" src="attachments/2022/grouping_loss.png" style="width: 360px;" />
<p class="caption">Validating probabilistic predictions of classifiers must go account
not only for the average error given an predicted score, but also for
the dispersion of errors.</p>
</div>
<p>Ensuring that a classifier gives reliable confidence scores is essential
for informed decision-making, in particular in high-stakes areas such as
health. For instance, before using a clinical prognostic model, we want
to establish that for a given individual is attributes probabilities of
different clinical outcomes that can be indeed trusted. To this end,
recent work has focused on miscalibration, <em>i.e.</em>, the over or under
confidence of model scores.</p>
<p>Yet calibration is not enough: even a perfectly calibrated classifier
with the best possible accuracy can have confidence scores that are far
from the true posterior probabilities, if it is over-confident for some
samples and under-confident for others. This is captured by the grouping
loss, created by samples with <strong>the same confidence scores but different
true posterior probabilities</strong>. Proper scoring rule theory shows that given
the calibration loss, the missing piece to characterize individual errors
is the grouping loss. While there are many estimators of the calibration
loss, none exists for the grouping loss in standard settings. In
<a class="reference external" href="https://arxiv.org/abs/2210.16315">Perez-Level 2023</a>, we propose an
estimator to approximate the grouping loss. We show that modern neural
network architectures in vision and NLP exhibit grouping loss, notably in
distribution shifts settings, which highlights the importance of
pre-production validation.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="reweighting-randomized-trials-for-generalization-finite-sample-error-and-variable-selection">
<h3><a class="toc-backref" href="#toc-entry-9">Reweighting randomized trials for generalization: finite sample error and variable selection</a></h3>
<div class="figure align-right">
<img alt="" src="attachments/2022/reweighting_trial.png" style="width: 360px;" />
<p class="caption">There may be a sampling bias between a randomized trial and the
target population.</p>
</div>
<p>Randomized Controlled Trials (RCTs) are ideal experiments to establish
causal statement. However, they may suffer from limited scope, in
particular, because they may have been run on non-representative samples:
some RCTs over- or under- sample individuals with certain characteristics
compared to the target population, for which one wants conclusions on
treatment effectiveness. Re-weighting trial individuals to match the
target population can improve the treatment effect estimation.</p>
<p>In <a class="reference external" href="https://hal.science/hal-03822662">Colnet 2022</a>, we establish the
exact expressions of the bias and variance of such reweighting procedures
- also called Inverse Propensity of Sampling Weighting (IPSW) - in
presence of categorical covariates for any sample size. Such results
allow us to compare the theoretical performance of different versions of
IPSW estimates. Besides, our results show how the performance (bias,
variance, and quadratic risk) of IPSW estimates depends on the two sample
sizes (RCT and target population). A by-product of our work is the proof
of consistency of IPSW estimates. Results also reveal that IPSW
performances are improved when the trial probability to be treated is
estimated (rather than using its oracle counterpart). In addition, we
study <strong>choice of variables</strong>: how including covariates that are not
necessary for identifiability of the causal effect may impact the
asymptotic variance. Including covariates that are shifted between the
two samples but not treatment effect modifiers increases the variance
while non-shifted but treatment effect modifiers do not.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="challenges-to-clinical-impact-of-ai-in-medical-imaging">
<h3><a class="toc-backref" href="#toc-entry-10">Challenges to clinical impact of AI in medical imaging</a></h3>
<p>I have worked for many years on research in computer analysis of medical
images. In particular, I am convinced that machine learning bears many
promises to improve patients’ health. However, I cannot be blind to the
fact that a number of systematic challenges are slowing down the progress
of the field.</p>
<p>In <a class="reference external" href="https://www.nature.com/articles/s41746-022-00592-y">Varoquaux &amp; Cheplygina</a>, we tried to take
a step back on these challenges, from limitations of the data, such as
biases, to research incentives, such as optimizing for publication. We
reviewed roadblocks to developing and assessing methods. Building our
analysis on evidence from the literature and data challenges, we showed
that at every step, potential biases can creep.</p>
<ul class="simple">
<li>First, larger datasets do not bring increased prediction accuracy and
may suffer from biases.</li>
<li>Second, evaluations often miss the target, with evaluation error larger
than algorithmic improvements, improper evaluation procedures and
leakage, metrics that do not reflect the application, incorrectly chosen
baselines, and improper statistics.</li>
<li>Finally, we show how publishing too often leads to distorted incentives.</li>
</ul>
<p>On a positive note, we also discuss on-going efforts to counteract these
problems and provide recommendations on how to further address these
problems in the future.</p>
<p>This was a fun exercise. I realize that I still need to sit on it and
introspect how it has shaped my research agenda, because I think it has
pushed me to choose specific emphases (such as model evaluation, or
focusing on rich data sources).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="privacy-preserving-synthetic-educational-data-generation">
<h3><a class="toc-backref" href="#toc-entry-11">Privacy-preserving synthetic educational data generation</a></h3>
<p>Soda also works on other applications than health, for instance
education. In this direction, I would like to highlight work in which I
did not participate, by Jill-Jenn Vie, another PI of the team.</p>
<p>Institutions collect massive learning traces but they may not disclose it
for privacy issues. Synthetic data generation opens new opportunities for
research in education. <a class="reference external" href="https://hal.inria.fr/hal-03715416">Vie 2022</a>
presented a generative model for educational data that can preserve the
privacy of participants, and an evaluation framework for comparing
synthetic data generators. We show how naive pseudonymization can lead to
re-identification threats and suggest techniques to guarantee privacy. We
evaluate our method on existing massive educational open datasets.</p>
<p>The tension between privacy of individuals and the need for datasets for
open science is a real and important one.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This was just a quick glance of what we do at soda, and we are just
warming up. I am super excited about this research. I hope that it will
matter.</p>
<p>I truely believe that more and better machine learning can help health
and social science to draw new insight from new datasets.</p>
</div>
</div>

            <div class="hr" style="margin-bottom: -.5em;"></div>
<!--<script src="https://apis.google.com/js/platform.js" async defer></script>-->
<span class="social_links">
<!--<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="GaelVaroquaux">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js" async defer></script>
-->
<!-- Place this tag where you want the +1 button to render. -->
<span class="g-plusone" data-size="medium"></span>
</span>            <a href="#" class="go-top">Go Top</a>
<footer class="footer">
    <p>&copy; Gaël Varoquaux &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    &ndash;
    <a href="https://gael-varoquaux.info/legal.html">Mentions légales</a>
    </p>
</footer>        </div>
    </div>
</div>
    <script
src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
    <script>
    // Highlight the current section in the TOC
(function () {
    'use strict';
    var SectionScroller = {
        anchorTops: [],

        el: {
            anchors: document.querySelectorAll('.toc-backref'),
            anchorLinks: document.querySelectorAll('a.reference.internal')
        },
        
        forEach: function(array, callback, scope) {
            for (var i = 0, ii = array.length; i < ii; i++) {
                callback.call(scope, i, array[i]);
            }
        },

        throttle: function (fn, threshhold, scope) {
          threshhold = threshhold || (threshhold = 250);
          var last;
          var deferTimer;
          return function () {
            var context = scope || this;
            var now = +new Date();
            var args = arguments;
            if (last && now < last + threshhold) {
              // hold on to it
              clearTimeout(deferTimer);
              deferTimer = setTimeout(function () {
                last = now;
                fn.apply(context, args);
              }, threshhold);
            } else {
              last = now;
              fn.apply(context, args);
            }
          };
        },
        
        mathSign: function (x) {
            x = +x; // convert to a number
            if (x === 0 || isNaN(x)) {
                return x;
            }
            return x > 0 ? 1 : -1;
        },

        anchorGetter: function () {
            var SS = SectionScroller;
            for (var i = 0, max = SS.el.anchors.length; i < max; i++) {
                SS.anchorTops[i] = SS.el.anchors[i].offsetTop;
            }
            for (var j = 0, jj = SS.anchorTops.length; j < jj; j++) {
                if (SS.anchorTops[j] - 350 < window.scrollY) {
                    for (var x = 0, xx = SS.el.anchors.length; x < xx; x++) {
                        SS.el.anchorLinks[x].classList.remove('selected');
                    }
                    SS.el.anchorLinks[j].classList.add('selected');
                }
            }
        },
        
        smooth: function (e) {
            var id = e.currentTarget.getAttribute('href');
            var node = document.querySelector(id);
            var nodeTop = node.offsetTop;
            var winTop = window.scrollY;
            var sign = SectionScroller.mathSign(nodeTop);
            var scrollAmnt;
            var down; 
            if (nodeTop > winTop) {
                down = true;
                scrollAmnt = nodeTop - winTop;
            } else {
                down = false;
                scrollAmnt = Math.abs(winTop - nodeTop);
            }
            
            var scroller = function () {
                if (down) {
                    window.scrollTo(0, window.scrollY + 1);
                } else {
                    window.scrollTo(0, window.scrollY - 1);
                }
                scrollAmnt--;
                if (scrollAmnt > 0)  {
                    window.requestAnimationFrame(scroller);
                }
            };
            window.requestAnimationFrame(scroller);
            e.preventDefault();
        },
        
        smoothScroll: function(e) {
            var id = e.currentTarget.getAttribute('href');
            var node = document.querySelector(id);
            var scrollContainer = node;
            do { //find scroll container
                scrollContainer = scrollContainer.parentNode;
                if (!scrollContainer) return;
                scrollContainer.scrollTop += 1;
            } while (scrollContainer.scrollTop === 0);

            var targetY = 0;
            do { //find the top of target relatively to the container
                if (node == scrollContainer) break;
                targetY += node.offsetTop;
            } while (node === node.offsetParent);

            var scroll = function(c, a, b, i) {
                i++; if (i > 30) return;
                c.scrollTop = a + (b - a) / 30 * i;
                setTimeout(function(){ scroll(c, a, b, i); }, 20);
            };
            // start scrolling
            scroll(scrollContainer, scrollContainer.scrollTop, targetY, 0);
            e.preventDefault();
        },

        events: function () {
            var SS = SectionScroller;
            window.addEventListener('scroll', SS.throttle(SS.anchorGetter, 150));
            SS.forEach(SS.el.anchorLinks, function (index, link) {
                link.addEventListener('click', SS.smooth);
            });
        },

        init: function () {
            SectionScroller.anchorGetter();
            SectionScroller.events();
        }
    };

    SectionScroller.init();
})();
</script>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
    <script  language="JavaScript" type="text/javascript">
    /* From http://evirtus.net/pub/eflickrstream.asp */
    /* Global variables */
    var bolOnLoadRun=false;
    var bolFlickrRun=false;
    var objFlickrOutput=null;
    
    /* OnLoad events */
    window.onload = function() {
    bolOnLoadRun=true;
    if (! /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
	eFlickrStream();
    };
    }
    
    /*
    eFlickrStream - Lovely, lovely photos! :-)
    - 02.08.2007 @ 14:33: Initial version
    */
    function eFlickrStream() {
    if (!bolFlickrRun ) { return false; } else { bolFlickrRun=false; }
    if ((!document.createElement) && (!document.getElementById) && (!document.getElementsByTagName) ) { return false; }// Test for required browser capabilities
    
    /*   *** Options/start ***   */
    var strTarget='flickrstream';// Target container for the flickr badge (must allready exist in the document)
    /*   *** Options/end ***     */
    
    if (!document.getElementById(strTarget)){return false;}// Exsist if target doesn't exsist
    
    var objTarget=document.getElementById(strTarget);
    objTarget.appendChild(objFlickrOutput);// Append output
    
    objFlickrOutput=null;// We're done, delete stored variable value
    objFlickr=null;
    }
    
    /*
    jsonFlickrFeed - Triggered when the Flickr json "feed" is loaded, generates Flickr photos output list item (Deefer "trigger method" from Patrick Quinn-Graham's DOM Flickr Badge)
    - 02.08.2007 @ 14:33: Initial version
    - 23.11.2007 @ 08:24: Updated to use eSetAttr(), enables the flickr link in IE
    - 29.11.2007 @ 05:52: Some changes for easier configuration (of both options and text-strings)
    */
    function jsonFlickrFeed(objFlickr) {
    if ((!document.createElement) && (!document.getElementById) && (!document.getElementsByTagName) ) { return false; }// Test for required browser capabilities
    
    /*   *** Options/start ***   */
    var intMaxImages=10;// Maximum number of images to show (1-20)
    var bolThumbSquare=true;// Load the square thumbnails
    var intThumbWidth=75;// Thumbnail width (omitted if set to "0")
    var strLightbox='flickrstream';// Lightbox "group name" (define to mark the thumbnails for lightbox usage, adds rel="lightbox[value]" to image links)
    var strImgAlt='[title]';// Alternative title for images ("[title]" will be replaced by image title)
    var strImgLinkTitle='View a larger version of \"[title]\"';// Link title for the image link
    /*   *** Options/end ***     */
    
    var objElm,objTxt,objImg,objLnk,objTmp,strTmp;
    var intPhotos=objFlickr.items.length;
    var objOut=document.createElement('ul');
    objOut.setAttribute('class','flickrlist');
    
    for (var iCntA=0; ( (iCntA<intPhotos) && (iCntA<intMaxImages)); iCntA++) {
    
	objElm=document.createElement('li');// Create item container element (<li>)
    
	objLnk=document.createElement('a');// Create link (to the large(r) photo)
	objLnk.setAttribute('href',objFlickr.items[iCntA].link);
	objLnk.setAttribute('title',strImgLinkTitle.replace('[title]',objFlickr.items[iCntA].title));
	if (strLightbox!=''){objLnk.setAttribute('rel','lightbox['+strLightbox+']');}// Add relation value for lightbox usage
    
	strTmp=objFlickr.items[iCntA].media.m;// Retreive thumbnail URI
	if (bolThumbSquare){strTmp=strTmp.replace('_m.jpg','_s.jpg');}// Swap default thumbnail for square...
    
	objImg=document.createElement('img');// Main thumbnail
	eSetAttr(objImg,'class','photo');
	objImg.setAttribute('src',strTmp);
	objImg.setAttribute('alt',strImgAlt.replace('[title]',objFlickr.items[iCntA].title));
	if (intThumbWidth!=0){objImg.setAttribute('width',intThumbWidth);}
    
	objLnk.appendChild(objImg);// Append thumbnail to link
	objElm.appendChild(objLnk);// Append link to container (li)

	objOut.appendChild(objElm);// Append container to output object
	}
    
    objFlickrOutput=objOut;// Store output for later use...
    
    if (bolOnLoadRun) {
	eFlickrStream();
	}
    else {
	bolFlickrRun=true;
	}
    }
    
    /*
    eSetAttr/eGetAttr - An attempt to tame IE's weird DOM model
    - 22.11.2007 @ 12:50 - Initial version
    */
    function eSetAttr(objTarget,strAttr,strValue) {
    if (typeof window.attachEvent!='undefined' && typeof window.opera=='undefined') {
    //    //Set attributes for IE
	switch (strAttr) {
	    case('class'):
		objTarget.setAttribute('className',strValue);
		break;
	    case('style'):
		objTarget.style.cssText=strValue;
		break;
	    default:
		objTarget.setAttribute(strAttr,strValue);
		break;
	    }
	}
    else {
    //    //Set attributes for /Other browsers/
	objTarget.setAttribute(strAttr,strValue);
	}
    //66885349@N03
    }
    </script>
    <script type="text/javascript" src="https://api.flickr.com/services/feeds/photos_public.gne?id=66885349@N03&amp;format=json&amp;" defer="defer"></script>
</body>
</html>